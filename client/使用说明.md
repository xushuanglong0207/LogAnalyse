# 日志分析工具 - 使用说明

## 🎯 快速上手

### 启动应用
双击 `start-final.bat` 或在命令行运行：
```bash
electron public/electron.js
```

### 界面介绍
应用包含6个主要功能模块：
- 🏠 **首页**: 功能概览和快速入口
- 📄 **单个分析**: 分析单个日志文件
- 📁 **全量分析**: 分析压缩包中的所有日志
- 📋 **规则管理**: 管理分析规则
- 📊 **分析报告**: 查看分析结果
- ⚙️ **设置**: 配置应用参数

## 📄 单个日志分析

### 步骤说明
1. 点击顶部的"单个分析"标签
2. 点击"选择文件"按钮，选择要分析的日志文件
3. 支持的文件格式：`.log`, `.txt`, `.out` 等
4. 点击"开始分析"按钮
5. 等待分析完成，自动跳转到报告页面

### 分析结果
- **总行数**: 日志文件的总行数
- **发现问题**: 检测到的问题数量
- **高危问题**: 严重级别的问题数量
- **问题详情**: 每个问题的详细信息，包括：
  - 问题类型和描述
  - 所在行号
  - 原始日志内容
  - 匹配的规则名称

## 📁 全量压缩包分析

### 支持格式
- `.zip` - ZIP压缩包
- `.tar` - TAR压缩包
- `.gz` - GZIP压缩包
- `.tgz` - TAR.GZ压缩包

### 使用方法
1. 点击"全量分析"标签
2. 选择压缩包文件
3. 系统自动解压并分析所有日志文件
4. 生成综合分析报告，包含：
   - 所有文件的统计信息
   - 按文件分组的问题列表
   - 每个问题的源文件信息

### 分析过程
- 自动解压到临时目录
- 递归扫描所有日志文件（.log, .txt, .out, .err）
- 并发分析多个文件
- 合并所有分析结果
- 自动清理临时文件

## 📋 规则管理

### 内置规则
系统预置了常用的日志分析规则：
- **错误日志规则**: 匹配 ERROR 级别日志
- **警告日志规则**: 匹配 WARN 级别日志  
- **异常堆栈规则**: 匹配异常堆栈信息

### 规则操作
- **同步规则**: 从服务端获取最新规则
- **添加规则**: 创建自定义分析规则
- **导出规则**: 备份规则配置到文件
- **启用/禁用**: 控制规则是否生效
- **删除规则**: 移除不需要的规则

### 添加自定义规则
1. 点击"添加规则"按钮
2. 在弹出的对话框中填写：
   - **规则名称**: 如"数据库错误"
   - **匹配模式**: 支持正则表达式，如`database.*error|connection.*failed`
   - **规则类型**: 选择"正则表达式"或"关键字匹配"
   - **问题描述**: 详细描述这个规则检测的问题
   - **优先级**: 选择低(3)、中(5)、高(8)、紧急(10)
3. 点击"保存规则"完成添加

## ⚙️ 设置配置

### 服务端配置
- **服务端地址**: 配置后端服务器地址（默认：http://172.17.20.117:8001）
- **自动同步规则**: 启动时自动从服务端同步规则
- **测试连接**: 验证服务端连接是否正常

### 数据管理
- **保存设置**: 保存当前配置
- **清除所有数据**: 删除所有本地数据（规则、设置、报告）

## 📊 分析报告

### 报告内容
- **统计概览**: 总行数、问题数量、高危问题统计
- **问题列表**: 详细的问题信息列表
- **导出功能**: 将报告导出为文本文件

### 导出报告
1. 分析完成后，在报告页面点击"导出报告"
2. 选择保存位置
3. 生成包含完整分析结果的文本文件

## 🔧 高级功能

### 规则语法
支持两种规则类型：
1. **正则表达式**: 使用正则表达式匹配日志内容
   - 示例：`ERROR|error|Error` 匹配包含错误关键字的行
2. **关键字匹配**: 简单的关键字包含匹配
   - 示例：`database error` 匹配包含此短语的行

### 服务端同步
1. 在设置中配置正确的服务端地址
2. 启用"自动同步规则"
3. 应用启动时会自动从服务端获取最新规则
4. 手动点击"同步规则"也可以立即同步

## 🐛 故障排除

### 常见问题

**Q: 点击"选择文件"没有反应？**
A: 确保在Electron环境中运行，不是在浏览器中打开

**Q: 分析结果显示"未发现问题"？**
A: 检查规则是否正确配置，或者日志内容确实没有匹配的问题

**Q: 规则同步失败？**
A: 检查服务端地址配置是否正确，服务端是否正常运行

**Q: 应用启动失败？**
A: 确保已安装Node.js和Electron，尝试重新安装依赖

### 调试方法
1. 按F12打开开发者工具
2. 查看Console标签中的错误信息
3. 检查Network标签中的网络请求状态

## 📝 测试数据

项目包含测试日志文件 `test_log.txt`，包含各种类型的日志条目，可用于测试分析功能。

## 💡 使用技巧

1. **批量处理**: 对于多个文件，建议打包成压缩包后使用全量分析
2. **规则优化**: 根据实际需求调整规则优先级和匹配模式
3. **定期同步**: 定期从服务端同步规则以获取最新的分析能力
4. **报告备份**: 重要的分析报告建议及时导出保存

---

**版本**: v1.0.0  
**更新时间**: 2024-09-04
